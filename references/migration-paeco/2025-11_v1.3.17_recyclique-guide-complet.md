# ğŸ“˜ GUIDE COMPLET RECYCLIQUE + PAHEKO

**Version**: 1.3.17  
**Date**: Novembre 2025  
**Auteur**: RecyClique Distribution  
**Public**: DÃ©veloppeurs, Administrateurs Ressourceries

---

## ğŸ“‘ TABLE DES MATIÃˆRES

1. [Vue d'ensemble](#vue-densemble)
2. [Architecture systÃ¨me](#architecture-systÃ¨me)
3. [Extensions/Modules requis](#extensionsmodules-requis)
4. [Installation Docker Compose](#installation-docker-compose)
5. [Configuration dÃ©taillÃ©e par module](#configuration-dÃ©taillÃ©e-par-module)
6. [Scripts d'automatisation](#scripts-dautomatisation)
7. [DÃ©ploiement en production](#dÃ©ploiement-en-production)
8. [Maintenance et mises Ã  jour](#maintenance-et-mises-Ã -jour)
9. [Troubleshooting](#troubleshooting)
10. [Ressources](#ressources)

---

## ğŸ¯ VUE D'ENSEMBLE

### Qu'est-ce que RecyClique ?

RecyClique est une **distribution prÃ©configurÃ©e** combinant :
- **Frontend** : PWA React/Vite (interface tactile caisse)
- **Middleware** : API FastAPI (orchestration, agents IA)
- **Backend** : Paheko (comptabilitÃ©, gestion associative, stock)
- **DonnÃ©es** : PostgreSQL + Redis

### Cas d'usage

âœ… Gestion complÃ¨te ressourcerie/recyclerie  
âœ… Caisse tactile multi-moyens paiement  
âœ… TraÃ§abilitÃ© objets (entrÃ©e/sortie/poids)  
âœ… Valorisation temps bÃ©nÃ©vole  
âœ… DÃ©clarations Ã©co-organismes  
âœ… ComptabilitÃ© associative conforme  
âœ… Interface IA conversationnelle (optionnel)

### Architecture gÃ©nÃ©rale

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  RecyClique Frontend (React/Vite)â”‚
â”‚  PWA Tactile - Port 4444         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  RecyClique API (FastAPI)        â”‚
â”‚  Middleware + Agents IA          â”‚
â”‚  Port 4433                       â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚                    â”‚
â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Paheko API â”‚    â”‚  PostgreSQL     â”‚
â”‚ Port 8080  â”‚    â”‚  Port 5432      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â–²
                         â”‚
                   â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”
                   â”‚   Redis   â”‚
                   â”‚ Port 6379 â”‚
                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ—ï¸ ARCHITECTURE SYSTÃˆME

### Composants

| Composant | RÃ´le | Technologie | Port |
|-----------|------|-------------|------|
| Frontend | Interface caisse tactile | React 18 / Vite | 4444 |
| API | Orchestration mÃ©tier + IA | FastAPI + Claude SDK | 4433 |
| Backend | ComptabilitÃ© + Gestion | Paheko 1.3.17 (PHP) | 8080 |
| Base de donnÃ©es | DonnÃ©es mÃ©tier persistantes | PostgreSQL 15 | 5432 |
| Cache | Sessions + Cache haute performance | Redis 7 | 6379 |

### Flux de donnÃ©es

```
OpÃ©rateur (tablette)
    â”‚ Scan code-barre
    â”‚ Saisie quantitÃ©/prix
    â–¼
Frontend React
    â”‚ appel API REST
    â–¼
Middleware FastAPI
    â”‚ (validation, transformation, agents IA)
    â”œâ”€â–º Paheko API (comptabilitÃ©, stock)
    â”œâ”€â–º PostgreSQL (donnÃ©es)
    â””â”€â–º Redis (cache session)
    â”‚
    â–¼
RÃ©ponse JSON
    â”‚ affichage ticket
    â–¼
OpÃ©rateur (impression/paiement)
```

---

## ğŸ“¦ EXTENSIONS/MODULES REQUIS

### Extensions Natives Paheko Ã  Activer

#### 1. **Caisse informatisÃ©e** â­ (Critique)

**Description** : Point de vente tactile, gestion tickets, moyens paiement  
**Installation** : Native - Ã  activer dans Configuration > Extensions  
**DÃ©pendances** : Aucune  
**Taille** : ~2 MB

**FonctionnalitÃ©s** :
- Interface tactile configurable
- Multi-moyens paiement (espÃ¨ces, CB, chÃ¨que, virement, bons)
- Tickets PDF imprimables
- Gestion multi-registres (plusieurs postes de caisse)
- Statistiques de vente en temps rÃ©el
- Synchronisation comptable automatique

**Compte comptable** : Classe 7 (Ventes et produits connexes)

#### 2. **Gestion de stock** â­ (Critique)

**Description** : Suivi entrÃ©es/sorties, inventaires, rÃ©ceptions  
**Installation** : Incluse avec Caisse  
**DÃ©pendances** : Caisse informatisÃ©e  
**Taille** : IntÃ©grÃ©e

**FonctionnalitÃ©s** :
- Stock actualisÃ© par vente
- Inventaires pÃ©riodiques
- Receptions matÃ©riel
- Historique mouvements
- Alertes rupture stock

**Compte comptable** : 603 (Variation stocks)

#### 3. **Saisie au poids** â­ (Critique pour Ã©co-organismes)

**Description** : DÃ©clarations Ã©co-organismes, traÃ§abilitÃ© poids  
**Installation** : Extension - Configuration > Extensions > Activer  
**DÃ©pendances** : Caisse informatisÃ©e  
**Taille** : ~3 MB

**FonctionnalitÃ©s** :
- Saisie poids par matiÃ¨re (kg, tonnes, etc.)
- EntrÃ©es/sorties pondÃ©rÃ©es
- Correspondances caisse â†” poids
- Import automatique post-caisse
- Historique traÃ§abilitÃ©
- Export dÃ©clarations

**Compte comptable** : 754 (Revenus divers)

#### 4. **Suivi du temps bÃ©nÃ©vole** â­ (Important)

**Description** : Valorisation heures bÃ©nÃ©voles, comptabilisation  
**Installation** : Extension - Configuration > Extensions > Activer  
**DÃ©pendances** : Aucune  
**Taille** : ~2 MB

**FonctionnalitÃ©s** :
- ChronomÃ¨tre en temps rÃ©el
- CatÃ©gories de tÃ¢ches (tri, admin, rÃ©paration, etc.)
- Taux horaires personnalisÃ©s par compÃ©tence
- Valorisation automatique en comptabilitÃ©
- Rapports bÃ©nÃ©volat
- Export pour subventions

**Compte comptable** : 864/875 (BÃ©nÃ©volat)

#### 5. **Gestion du matÃ©riel** âœ… (Important)

**Description** : Suivi objets individuels, prÃªts, cessions, photos  
**Installation** : Extension - Configuration > Extensions > Activer  
**DÃ©pendances** : Aucune  
**Taille** : ~2 MB

**FonctionnalitÃ©s** :
- Fiche matÃ©riel par objet unique
- Photos attachÃ©es
- Historique prÃªts/cessions
- Code-barre + numÃ©ro de sÃ©rie
- Ã‰tats configurables (excellent, bon, moyen, hors-service)
- Rapports d'inventaire

#### 6. **Documents et GED** âœ… (Accessoire)

**Description** : Gestion documentaire, attachement photos et justificatifs  
**Installation** : Native - par dÃ©faut activÃ©e  
**DÃ©pendances** : Aucune  
**Taille** : IntÃ©grÃ©e

**FonctionnalitÃ©s** :
- Gestion centralisÃ©e documents
- Upload photos/PDFs
- CatÃ©gorisation documents
- Recherche full-text
- Quota stockage configurable

#### 7. **Agenda et contacts** âœ… (Optionnel)

**Description** : Calendrier activitÃ©s, gestion Ã©vÃ©nements  
**Installation** : Extension - Configuration > Extensions > Activer  
**DÃ©pendances** : Aucune  
**Taille** : ~1 MB

**FonctionnalitÃ©s** :
- Calendrier partagÃ©
- Ã‰vÃ©nements associatifs
- Rappels notifications
- ICalendar compatible

#### 8. **Site web** âœ… (Optionnel)

**Description** : Vitrine publique, intÃ©gration vente en ligne  
**Installation** : Native - Ã  configurer  
**DÃ©pendances** : Aucune  
**Taille** : ~1 MB

**FonctionnalitÃ©s** :
- Pages CMS personnalisables
- Galerie produits
- IntÃ©gration rÃ©seaux sociaux
- Analytics

---

### Extensions PersonnalisÃ©es Ã  DÃ©velopper

#### A. **Module DÃ©clarations Ã©co-organismes**

**Objectif** : Export automatique pour Eco-mobilier, Valdelia, etc.

**FonctionnalitÃ©s** :
- RÃ©conciliation caisse â†” poids
- Calcul tonnages par flux
- Format d'export conforme CERFA
- Historique dÃ©clarations

**Technologie** : Module Brindille + API REST  
**Effort** : ~40h dÃ©veloppement  
**DÃ©pendances** : Saisie au poids + Caisse

#### B. **Interface API RecyClique**

**Objectif** : Pont API vers agents IA conversationnels

**Endpoints** :
- `/caisse/ventes` - CrÃ©er/lister ventes
- `/stock/inventaire` - Gestion stock
- `/benevolat/temps` - Saisie heures
- `/materiel/objets` - Suivi objets individuels
- `/declarations/export` - Export dÃ©clarations

**Technologie** : FastAPI Python  
**Effort** : ~30h dÃ©veloppement

#### C. **Tarification dynamique**

**Objectif** : SystÃ¨me prix minimum + contribution variable

**FonctionnalitÃ©s** :
- Calcul prix selon Ã©tat objet
- Suggestion prix basÃ©e ML
- Historique prix par catÃ©gorie
- A/B testing tarification

**Technologie** : Module Brindille + API  
**Effort** : ~20h dÃ©veloppement

#### D. **IntÃ©gration agents IA**

**Objectif** : Classification automatique, suggestion tarification

**FonctionnalitÃ©s** :
- Bot classification objets
- Suggestion descriptif/prix
- Chat support membres
- Notifications intelligentes

**Technologie** : Claude SDK + FastAPI  
**Effort** : ~50h dÃ©veloppement

---

## ğŸ³ INSTALLATION DOCKER COMPOSE

### PrÃ©requis

- **Docker** â‰¥ 24.0 (https://docs.docker.com/get-docker/)
- **Docker Compose** â‰¥ 2.20 (inclus Docker Desktop)
- **RAM** : 4 GB minimum (8 GB recommandÃ©)
- **Disque** : 20 GB disponible
- **RÃ©seau** : AccÃ¨s internet pour tÃ©lÃ©chargement images

### VÃ©rifier les prÃ©requis

```bash
# VÃ©rifier Docker
docker --version
# Sortie: Docker version 24.0.0+

# VÃ©rifier Docker Compose
docker compose version
# Sortie: Docker Compose version 2.20.0+

# VÃ©rifier RAM disponible
free -h
# Sortie: 4+ GB disponible
```

### Ã‰tape 1 : TÃ©lÃ©charger la distribution

```bash
# Cloner le repo distribution
git clone https://github.com/votre-org/recyclique-distribution
cd recyclique-distribution

# Structure crÃ©Ã©e
ls -la
# docker-compose.yml
# .env.example
# paheko/
# middleware/
# frontend/
# data/
# scripts/
# docs/
```

### Ã‰tape 2 : Configurer les variables d'environnement

```bash
# Copier le fichier d'exemple
cp .env.example .env

# Ã‰diter .env avec vos valeurs
cat > .env << 'EOF'
# ===== POSTGRESQL =====
POSTGRES_USER=paheko
POSTGRES_PASSWORD=ChoixUnMotDePasseSecurise123!
POSTGRES_DB=paheko_db

# ===== PAHEKO API =====
PAHEKO_API_USER=api_recyclique
PAHEKO_API_PASSWORD=APIPasswordSecurise456!

# ===== PAHEKO CONFIG =====
PAHEKO_WWW_URI=/
PAHEKO_FILE_STORAGE_QUOTA=5000000

# ===== REDIS =====
REDIS_PASSWORD=RedisSecure789!

# ===== DOMAINE (production) =====
DOMAIN=localhost
# Pour production: DOMAIN=recyclique.example.com

# ===== PORTS =====
FRONTEND_PORT=4444
API_PORT=4433
PAHEKO_PORT=8080
EOF

# VÃ©rifier la sÃ©curitÃ© (pas de mots de passe par dÃ©faut)
grep "changeme\|PASSWORD\|default" .env
# RÃ©sultat: aucune ligne = OK âœ“
```

### Ã‰tape 3 : Lancer la distribution

```bash
# CrÃ©er les rÃ©pertoires de donnÃ©es
mkdir -p data/{paheko_data,postgres_data,redis_data}
chmod 755 data/*/

# VÃ©rifier les fichiers Docker
ls -la paheko/Dockerfile* middleware/Dockerfile* docker-compose.yml
# Tous prÃ©sents? âœ“

# Lancer la stack
docker compose up -d

# VÃ©rifier le dÃ©marrage (2-3 minutes)
docker compose logs -f

# Attendue: "âœ… PostgreSQL prÃªt", "âœ… Redis prÃªt", "âœ… Paheko initialisÃ©"
```

### Ã‰tape 4 : VÃ©rifier l'installation

```bash
# VÃ©rifier tous les services
docker compose ps
# RÃ©sultat attendu:
# NAME              STATUS    PORTS
# recyclique_postgres   Up      5432/tcp
# recyclique_redis      Up      6379/tcp
# recyclique_paheko     Up      8080/tcp
# recyclique_api        Up      8000/tcp
# recyclique_frontend   Up      5173/tcp

# Tester les endpoints
curl -u paheko:votreMotDePasse http://localhost:8080/api/health
# RÃ©sultat: {"status": "ok"}

curl http://localhost:4433/health
# RÃ©sultat: {"status": "ok"}

curl http://localhost:4444/
# RÃ©sultat: HTML frontend
```

### Ã‰tape 5 : Configuration initiale Paheko

```bash
# AccÃ©der Ã  l'interface web
# URL: http://localhost:8080/

# Identifiants par dÃ©faut:
# Email: admin@example.com
# Mot de passe: admin

# âš ï¸ CHANGE LE MOT DE PASSE IMMÃ‰DIATEMENT
# Configuration > Utilisateurs > admin > Modifier
```

---

## âš™ï¸ CONFIGURATION DÃ‰TAILLÃ‰E PAR MODULE

### Module Caisse InformatisÃ©e

#### Configuration de base

```
Configuration > Caisse > ParamÃ¨tres
â”œâ”€ Devise: EUR
â”œâ”€ Format de nombre: 1 234,56
â”œâ”€ Format ticket: texte
â”œâ”€ Impression auto: OUI
â”œâ”€ Affichage prix: OUI
â””â”€ Affichage photos: OUI
```

#### CrÃ©er les catÃ©gories de produits

**Interface** : Caisse > Gestion des produits > CatÃ©gories

```
CatÃ©gorie 1 : Mobilier
â”œâ”€ Code comptable: 707 (Ventes)
â”œâ”€ Produits:
â”‚  â”œâ”€ Chaise bois (2â‚¬ - 50â‚¬)
â”‚  â”œâ”€ Table ronde (10â‚¬ - 150â‚¬)
â”‚  â””â”€ Commode (20â‚¬ - 200â‚¬)
â””â”€ Affichage: OUI

CatÃ©gorie 2 : Ã‰lectromÃ©nager
â”œâ”€ Code comptable: 707
â”œâ”€ Produits:
â”‚  â”œâ”€ Grille-pain (3â‚¬ - 25â‚¬)
â”‚  â”œâ”€ CafetiÃ¨re (5â‚¬ - 50â‚¬)
â”‚  â””â”€ Frigo (30â‚¬ - 300â‚¬)
â””â”€ Affichage: OUI

CatÃ©gorie 3 : Textile
â”œâ”€ Code comptable: 707
â”œâ”€ Produits:
â”‚  â”œâ”€ T-shirt (0,50â‚¬ - 10â‚¬)
â”‚  â”œâ”€ Jeans (1â‚¬ - 20â‚¬)
â”‚  â””â”€ Veste (2â‚¬ - 30â‚¬)
â””â”€ Affichage: OUI

CatÃ©gorie 4 : Livres
â”œâ”€ Code comptable: 707
â”œâ”€ Produits:
â”‚  â”œâ”€ Roman (0,50â‚¬ - 5â‚¬)
â”‚  â”œâ”€ Technique (1â‚¬ - 15â‚¬)
â”‚  â””â”€ Beaux-arts (2â‚¬ - 30â‚¬)
â””â”€ Affichage: OUI
```

#### Configurer les moyens de paiement

**Interface** : Caisse > Moyens de paiement

```
Moyen 1 : EspÃ¨ces
â”œâ”€ Type: TrÃ©sorerie
â”œâ”€ Compte comptable: 512 (Caisse)
â””â”€ Compte rÃ©conciliation: 5121

Moyen 2 : Carte bancaire
â”œâ”€ Type: Banque
â”œâ”€ Compte comptable: 514 (Compte bancaire)
â””â”€ Compte rÃ©conciliation: 5141

Moyen 3 : ChÃ¨que
â”œâ”€ Type: TrÃ©sorerie
â”œâ”€ Compte comptable: 512
â””â”€ Compte rÃ©conciliation: 5122

Moyen 4 : Virement
â”œâ”€ Type: Banque
â”œâ”€ Compte comptable: 514
â””â”€ Compte rÃ©conciliation: 5142

Moyen 5 : Bon d'achat
â”œâ”€ Type: Tiers
â”œâ”€ Compte comptable: 419 (Dettes)
â””â”€ Compte rÃ©conciliation: 4191
```

#### Workflow caisse

**Ouverture de session** :
```
Caisse > Sessions > Nouvelle session
â”œâ”€ OpÃ©rateur: [choisir utilisateur]
â”œâ”€ Registre: Caisse 1
â”œâ”€ Fond initial: 50â‚¬
â””â”€ Heure ouverture: [automatique]
```

**Encaisser une vente** :
```
Caisse > Encaisser une vente
â”œâ”€ Ã‰tape 1: SÃ©lectionner CatÃ©gorie
â”œâ”€ Ã‰tape 2: SÃ©lectionner Produit
â”œâ”€ Ã‰tape 3: QuantitÃ©
â”œâ”€ Ã‰tape 4: Prix (auto ou manuel)
â”œâ”€ Ã‰tape 5: Ajouter notes/destination
â”œâ”€ Ã‰tape 6: Panier (review lignes)
â””â”€ Ã‰tape 7: Paiement (espÃ¨ces/CB/etc.)
```

**Fermeture de session** :
```
Caisse > Sessions > Fermer session
â”œâ”€ VÃ©rifier montant thÃ©orique
â”œâ”€ Compter espÃ¨ces physiques
â”œâ”€ Enregistrer montant rÃ©el
â”œâ”€ Si Ã©cart: justification obligatoire
â””â”€ Synchronisation comptable auto
```

### Module Saisie au Poids

#### Installation

```bash
# Via interface
Configuration > Extensions > Saisie au poids > Installer & Activer

# Ou via script d'activation
php /scripts/activate-extensions.php "saisie_au_poids"
```

#### Configuration

**Interface** : Saisie au poids > Configuration

```
UnitÃ©s de mesure:
â”œâ”€ Kilogrammes (kg) âœ“
â”œâ”€ Tonnes (t) âœ“
â”œâ”€ Grammes (g) âœ“
â””â”€ Milliers de piÃ¨ces (k pcs)

CatÃ©gories matÃ©riaux:
â”œâ”€ Bois
â”œâ”€ MÃ©tal
â”œâ”€ Verre
â”œâ”€ Plastique
â”œâ”€ Textile
â”œâ”€ Papier-Carton
â””â”€ Ã‰lectronique

Correspondances Caisse â†” Poids:
â”œâ”€ Mobilier (bois) â†’ CatÃ©gorie Bois
â”œâ”€ Ã‰lectromÃ©nager (mÃ©tal) â†’ CatÃ©gorie MÃ©tal
â””â”€ [etc.]
```

#### Saisie manuelle

```
Saisie au poids > Nouvelle entrÃ©e
â”œâ”€ Date: [date du jour]
â”œâ”€ CatÃ©gorie matÃ©riau: [sÃ©lectionner]
â”œâ”€ Poids: [saisir en kg]
â”œâ”€ UnitÃ©: kg / t / g
â”œâ”€ Provenance: [description]
â””â”€ Notes: [dÃ©tails]
```

#### Import automatique depuis caisse

```
Saisie au poids > Importations > Depuis caisse
â”œâ”€ Session caisse: [derniÃ¨re clÃ´turÃ©e]
â”œâ”€ Correspondances: [vÃ©rifier mapping]
â”œâ”€ Simulation poids: [avant/aprÃ¨s]
â””â”€ Importer â†’ Enregistrement auto
```

#### DÃ©clarations Ã©co-organismes

```
Saisie au poids > DÃ©clarations > Nouvelle
â”œâ”€ PÃ©riode: [mois/trimestre]
â”œâ”€ Ã‰co-organisme: [Eco-mobilier / Valdelia / etc.]
â”œâ”€ Tonnages par flux: [calculÃ©s auto]
â”œâ”€ Format export: CERFA / CSV
â””â”€ GÃ©nÃ©rer & TÃ©lÃ©charger
```

### Module Suivi du Temps BÃ©nÃ©vole

#### Installation

```bash
Configuration > Extensions > Suivi du temps > Installer & Activer
```

#### Configuration des catÃ©gories de tÃ¢ches

**Interface** : Suivi du temps > Configuration > CatÃ©gories

```
CatÃ©gorie 1 : Administration
â”œâ”€ Taux horaire: 25,00 â‚¬/h
â”œâ”€ Compte dÃ©bit: 864 (Personnel bÃ©nÃ©vole)
â”œâ”€ Compte crÃ©dit: 875 (BÃ©nÃ©volat)
â””â”€ Actif: OUI

CatÃ©gorie 2 : Tri et valorisation
â”œâ”€ Taux horaire: 15,00 â‚¬/h
â”œâ”€ Compte dÃ©bit: 864
â”œâ”€ Compte crÃ©dit: 875
â””â”€ Actif: OUI

CatÃ©gorie 3 : Vente et accueil
â”œâ”€ Taux horaire: 18,00 â‚¬/h
â”œâ”€ Compte dÃ©bit: 864
â”œâ”€ Compte crÃ©dit: 875
â””â”€ Actif: OUI

CatÃ©gorie 4 : RÃ©paration technique
â”œâ”€ Taux horaire: 30,00 â‚¬/h
â”œâ”€ Compte dÃ©bit: 864
â”œâ”€ Compte crÃ©dit: 875
â””â”€ Actif: OUI

CatÃ©gorie 5 : Logistique
â”œâ”€ Taux horaire: 15,00 â‚¬/h
â”œâ”€ Compte dÃ©bit: 864
â”œâ”€ Compte crÃ©dit: 875
â””â”€ Actif: OUI
```

#### Saisie du temps

**Interface** : Suivi du temps > Nouvelle saisie

```
Option A : ChronomÃ¨tre en direct
â”œâ”€ SÃ©lectionner bÃ©nÃ©vole
â”œâ”€ SÃ©lectionner catÃ©gorie tÃ¢che
â”œâ”€ Cliquer "DÃ©marrer"
â”œâ”€ [travail bÃ©nÃ©vole]
â”œâ”€ Cliquer "ArrÃªter"
â””â”€ Enregistrer

Option B : Saisie manuelle rÃ©troactive
â”œâ”€ SÃ©lectionner bÃ©nÃ©vole
â”œâ”€ Date intervention
â”œâ”€ CatÃ©gorie tÃ¢che
â”œâ”€ DurÃ©e en heures (ex: 2h30)
â”œâ”€ Notes description
â””â”€ Enregistrer
```

#### Valorisation comptable

**Automatique** : AprÃ¨s validation saisie
```
Ã‰criture doublement:
â”œâ”€ DÃ©bit 864 (Personnel bÃ©nÃ©vole): montant valorisÃ©
â””â”€ CrÃ©dit 875 (BÃ©nÃ©volat): montant valorisÃ©

Exemple: 10h Ã  25â‚¬/h = 250â‚¬
â”œâ”€ DÃ©bit 864: 250â‚¬
â””â”€ CrÃ©dit 875: 250â‚¬
```

**Affichage** : ComptabilitÃ© > Ã‰critures
```
Tous les bÃ©nÃ©volats y apparaissent automatiquement
Consultation: ComptabilitÃ© > Compte de rÃ©sultat
â”œâ”€ Classe 8 (RÃ©sultats)
â”‚  â”œâ”€ 864 Personnel bÃ©nÃ©vole
â”‚  â””â”€ 875 BÃ©nÃ©volat (excÃ©dent/dÃ©ficit)
```

#### Rapports

**Interface** : Suivi du temps > Rapports

```
Rapport par bÃ©nÃ©vole:
â”œâ”€ PÃ©riode: [mois/trimestre/annÃ©e]
â”œâ”€ BÃ©nÃ©vole: [sÃ©lectionner]
â”œâ”€ Total heures: X h
â”œâ”€ Total valorisÃ©: Y â‚¬
â””â”€ DÃ©tail activitÃ©s

Rapport global:
â”œâ”€ PÃ©riode: [mois/trimestre/annÃ©e]
â”œâ”€ Total heures structure: X h
â”œâ”€ Total valorisÃ©: Y â‚¬
â”œâ”€ Top 5 bÃ©nÃ©voles
â””â”€ RÃ©partition par catÃ©gorie tÃ¢che

Export:
â”œâ”€ Format PDF / CSV / Excel
â”œâ”€ Signature bÃ©nÃ©voles: OUI/NON
â””â”€ Pour subvention: OUI/NON
```

### Module Gestion du MatÃ©riel

#### Installation

```bash
Configuration > Extensions > Gestion du matÃ©riel > Installer & Activer
```

#### Configuration types matÃ©riel

```
Type 1 : Mobilier
â”œâ”€ CatÃ©gories: Chaise, Table, Armoire, Commode, BibliothÃ¨que
â”œâ”€ Ã‰tats possibles: Excellent, Bon, Moyen, UsÃ©
â”œâ”€ DurÃ©e de vie moyenne: 10 ans
â””â”€ TraÃ§abilitÃ©: Code-barre

Type 2 : Ã‰lectromÃ©nager
â”œâ”€ CatÃ©gories: Petit Ã©lectromÃ©nager, Gros Ã©lectromÃ©nager
â”œâ”€ Ã‰tats possibles: Excellent, Bon, Moyen, RÃ©paration, DÃ©chet
â”œâ”€ DurÃ©e de vie moyenne: 5-8 ans
â””â”€ TraÃ§abilitÃ©: NumÃ©ro de sÃ©rie

Type 3 : Textile
â”œâ”€ CatÃ©gories: VÃªtements, Accessoires
â”œâ”€ Ã‰tats possibles: Excellent, Bon, Moyen, Tissu endommagÃ©
â”œâ”€ DurÃ©e de vie moyenne: 2-5 ans
â””â”€ TraÃ§abilitÃ©: Lot/lot_date

Type 4 : Livres
â”œâ”€ CatÃ©gories: Romans, Technique, Jeunesse
â”œâ”€ Ã‰tats possibles: Excellent, Bon, FatiguÃ©, EndommagÃ©
â”œâ”€ DurÃ©e de vie moyenne: 10+ ans
â””â”€ TraÃ§abilitÃ©: ISBN
```

#### Champs personnalisÃ©s par type

```
Mobilier:
â”œâ”€ Dimensions (L x P x H)
â”œâ”€ MatiÃ¨re
â”œâ”€ Couleur
â”œâ”€ Poids estimÃ©
â””â”€ Photo avant

Ã‰lectromÃ©nager:
â”œâ”€ Marque
â”œâ”€ ModÃ¨le
â”œâ”€ NumÃ©ro de sÃ©rie
â”œâ”€ Tension Ã©lectrique
â”œâ”€ DerniÃ¨re rÃ©vision
â””â”€ Photo avant

Textile:
â”œâ”€ Taille
â”œâ”€ MatiÃ¨re
â”œâ”€ Marque
â”œâ”€ Condition coutures
â””â”€ Photo avant

Livres:
â”œâ”€ Auteur
â”œâ”€ ISBN
â”œâ”€ Ã‰dition
â”œâ”€ AnnÃ©e publication
â””â”€ Photo couverture
```

#### Workflow objet unique

**EntrÃ©e**:
```
Gestion matÃ©riel > Nouvel objet
â”œâ”€ Type matÃ©riel: [sÃ©lectionner]
â”œâ”€ CatÃ©gorie: [sÃ©lectionner]
â”œâ”€ Ã‰tat initial: Excellent/Bon/Moyen
â”œâ”€ Champs spÃ©cifiques: [complÃ©ter]
â”œâ”€ Photos: [tÃ©lÃ©charger]
â”œâ”€ Code-barre: [scanner ou saisir]
â””â”€ Enregistrer â†’ CrÃ©ation fiche

âœ“ Objet assignÃ© d'un ID unique (ex: MAT-2025-0001)
```

**Suivi stock**:
```
Gestion matÃ©riel > Stock
â”œâ”€ Ã‰tat courant: [visible]
â”œâ”€ Historique mouvements:
â”‚  â”œâ”€ EntrÃ©e: 2025-01-15 (rÃ©cepteur: Jean)
â”‚  â”œâ”€ Stock: 2025-01-20 (localisation: AllÃ©e A)
â”‚  â”œâ”€ PrÃªt: 2025-02-01 â†’ 2025-02-28 (Ã : Marie)
â”‚  â””â”€ [autres mouvements]
â””â”€ Localisation actuelle: [affichÃ©e]
```

**Sortie/Cession**:
```
Gestion matÃ©riel > Sortie > Nouveau
â”œâ”€ Objet: [sÃ©lectionner par code-barre ou ID]
â”œâ”€ Motif sortie: Vente / Don / DÃ©chet / PrÃªt long terme
â”œâ”€ Destinataire: [sÃ©lectionner client/organisme]
â”œâ”€ Date sortie: [auto ou manuel]
â”œâ”€ Prix de vente: [si applicable]
â””â”€ Enregistrer â†’ Ã‰criture comptable auto

Ã‰critures gÃ©nÃ©rÃ©es:
â”œâ”€ Si Vente: DÃ©bit 512 (TrÃ©sorerie) / CrÃ©dit 707 (Vente)
â”œâ”€ Si Don: DÃ©bit 654 (Dons) / CrÃ©dit [actif]
â””â”€ Si DÃ©chet: DÃ©bit 654 / CrÃ©dit [actif]
```

#### TraÃ§abilitÃ© complÃ¨te

```
Exemple objet : Fauteuil rouge
ID: MAT-2025-0042

Historique:
â”œâ”€ 2025-01-20 09:30 EntrÃ©e
â”‚  â””â”€ Provenance: DÃ©pÃ´t vÃªtements, Ã‰tat: Bon
â”‚
â”œâ”€ 2025-01-25 14:15 Nettoyage + Photo
â”‚  â””â”€ OpÃ©rateur: Marc
â”‚
â”œâ”€ 2025-02-01 10:45 En stock
â”‚  â””â”€ Localisation: Showroom 2
â”‚
â”œâ”€ 2025-02-10 16:20 Vente
â”‚  â””â”€ Client: Dupont Marie, Prix: 85â‚¬, ReÃ§u: OUI
â”‚
â””â”€ TERMINÃ‰ âœ“ (Sortie dÃ©finitive)
```

---

## ğŸ”§ SCRIPTS D'AUTOMATISATION

### Script 1 : Initialisation Paheko

**Fichier** : `paheko/scripts/init-paheko.sh`

```bash
#!/bin/bash
set -e

echo "ğŸš€ Initialisation Paheko..."

# VÃ©rifier PostgreSQL
until pg_isready -h "$DB_HOST" -U "$DB_USER"; do
  echo "â³ Attente PostgreSQL..."
  sleep 2
done

# Initialiser la base
if [ ! -f "$PAHEKO_DATA_DIR/.initialized" ]; then
  echo "ğŸ“¦ CrÃ©ation structure Paheko..."
  
  # ExÃ©cuter migrations SQL
  psql -h "$DB_HOST" -U "$DB_USER" -d "$DB_NAME" \
    -f "/var/www/paheko/sql/schema.sql"
  
  # CrÃ©er utilisateur admin par dÃ©faut
  php /var/www/paheko/bin/paheko \
    user create \
    --login admin \
    --email admin@example.com \
    --password $(openssl rand -base64 12) \
    --admin
  
  echo "âœ… Paheko initialisÃ©"
  touch "$PAHEKO_DATA_DIR/.initialized"
fi

echo "âœ… PrÃªt"
```

### Script 2 : Activation Extensions

**Fichier** : `paheko/scripts/activate-extensions.php`

```php
<?php
/**
 * Script CLI activation extensions Paheko
 * Usage: php activate-extensions.php "caisse,stock,poids,benevolat"
 */

require_once __DIR__ . '/../include/init.php';

use Paheko\Plugins;

$extensions = explode(',', $argv[1] ?? '');

$mapping = [
    'caisse' => 'caisse',
    'stock' => 'stock', // inclus caisse
    'poids' => 'saisie_au_poids',
    'benevolat' => 'temps_benevolat',
    'materiel' => 'gestion_materiel',
    'agenda' => 'agenda',
    'documents' => 'documents_gestion',
    'web' => 'site_web',
];

echo "ğŸ”§ Activation extensions Paheko\n";

foreach ($extensions as $ext) {
    $ext = trim($ext);
    if (empty($ext)) continue;
    
    $name = $mapping[$ext] ?? $ext;
    
    try {
        $plugin = Plugins::get($name);
        
        if (!$plugin) {
            echo "  âŒ '$ext' introuvable\n";
            continue;
        }
        
        if (!$plugin->enabled) {
            $plugin->enable();
            echo "  âœ… '$ext' activÃ©e\n";
        } else {
            echo "  â„¹ï¸  '$ext' dÃ©jÃ  active\n";
        }
    } catch (Exception $e) {
        echo "  âš ï¸  '$ext': " . $e->getMessage() . "\n";
    }
}

echo "\nâœ… TerminÃ©\n";
```

### Script 3 : Configuration Initiale

**Fichier** : `paheko/scripts/configure-defaults.sql`

```sql
-- Configuration par dÃ©faut RecyClique
BEGIN;

-- DÃ©sactiver notifications par email pour test
UPDATE config SET value = 'off' WHERE key = 'emails_enabled';

-- Activer API
UPDATE config SET value = 'on' WHERE key = 'api_enabled';

-- CatÃ©gories comptables pour ressourcerie
INSERT INTO compta_comptes (numero, libelle, type) VALUES
    ('701', 'Ventes de produits finis', 'classe_7'),
    ('707', 'Ventes de marchandises', 'classe_7'),
    ('754', 'Revenus divers', 'classe_7'),
    ('603', 'Variation de stocks', 'classe_6'),
    ('864', 'Personnel bÃ©nÃ©vole', 'classe_8'),
    ('875', 'BÃ©nÃ©volat', 'classe_8');

-- Comptes de trÃ©sorerie
INSERT INTO compta_comptes (numero, libelle, type) VALUES
    ('512', 'Caisse', 'classe_5'),
    ('514', 'Compte bancaire', 'classe_5');

-- Comptes tiers
INSERT INTO compta_comptes (numero, libelle, type) VALUES
    ('419', 'Dettes diverses', 'classe_4');

COMMIT;
```

### Script 4 : Sauvegarde Quotidienne

**Fichier** : `scripts/backup.sh`

```bash
#!/bin/bash

BACKUP_DIR="${BACKUP_DIR:-./backups}"
KEEP_DAYS="${KEEP_DAYS:-7}"

mkdir -p "$BACKUP_DIR"

echo "ğŸ”„ Sauvegarde Paheko + Base de donnÃ©es..."

# Sauvegarde PostgreSQL
TIMESTAMP=$(date +%Y%m%d_%H%M%S)
pg_dump -h postgres -U paheko paheko_db | \
  gzip > "$BACKUP_DIR/paheko_db_$TIMESTAMP.sql.gz"

# Sauvegarde fichiers Paheko
tar -czf "$BACKUP_DIR/paheko_data_$TIMESTAMP.tar.gz" \
  data/paheko_data/

# Sauvegarde Redis
docker exec recyclique_redis redis-cli --rdb \
  /data/dump_$TIMESTAMP.rdb

# Nettoyer anciennes sauvegardes
find "$BACKUP_DIR" -name "*.gz" -mtime +$KEEP_DAYS -delete
find "$BACKUP_DIR" -name "*.rdb" -mtime +$KEEP_DAYS -delete

echo "âœ… Sauvegarde terminÃ©e"
ls -lh "$BACKUP_DIR" | tail -5
```

---

## ğŸš€ DÃ‰PLOIEMENT EN PRODUCTION

### Checklist PrÃ©-DÃ©ploiement

- [ ] Tous les tests fonctionnels passent en local
- [ ] Variables d'environnement configurÃ©es (.env)
- [ ] Mots de passe forts (minimum 16 caractÃ¨res)
- [ ] HTTPS/TLS configurÃ© sur reverse proxy
- [ ] Sauvegardes automatiques configurÃ©es
- [ ] Monitoring/alertes en place
- [ ] Plan de rollback documentÃ©

### Architecture Production (SchÃ©ma)

```
Internet
    â”‚
    â””â”€â–º Reverse Proxy (NGINX / Traefik)
           â”œâ”€ TLS/HTTPS
           â”œâ”€ Load balancing (si multi-instances)
           â””â”€ Rate limiting / WAF
                â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚           â”‚           â”‚
    â–¼           â–¼           â–¼
Frontend    API         Paheko
React       FastAPI     (PHP)
4444        4433        8080
    â”‚           â”‚           â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”
        â”‚             â”‚
    PostgreSQL   Redis
    5432         6379
        â”‚
    Volume Storage
    (NFS/S3)
```

### Fichier Docker Compose Production

```yaml
version: '3.8'

services:
  postgres:
    image: postgres:15-alpine
    restart: always
    environment:
      POSTGRES_PASSWORD: ${POSTGRES_PASSWORD}
      POSTGRES_DB: paheko_db
    volumes:
      - postgres_data:/var/lib/postgresql/data
    networks:
      - recyclique_network
    healthcheck:
      test: ["CMD", "pg_isready"]
      interval: 30s
      timeout: 10s
      retries: 5

  redis:
    image: redis:7-alpine
    restart: always
    command: redis-server --requirepass ${REDIS_PASSWORD}
    volumes:
      - redis_data:/data
    networks:
      - recyclique_network

  paheko:
    build: ./paheko
    restart: always
    depends_on:
      - postgres
      - redis
    environment:
      DB_HOST: postgres
      DB_PASSWORD: ${POSTGRES_PASSWORD}
      REDIS_HOST: redis
      REDIS_PASSWORD: ${REDIS_PASSWORD}
    volumes:
      - paheko_data:/var/www/paheko/data
    networks:
      - recyclique_network
    expose:
      - "80"

  api:
    build: ./middleware
    restart: always
    depends_on:
      - paheko
    environment:
      PAHEKO_URL: http://paheko
      API_ENV: production
    networks:
      - recyclique_network
    expose:
      - "8000"

  frontend:
    build: ./frontend
    restart: always
    networks:
      - recyclique_network
    expose:
      - "3000"

  nginx:
    image: nginx:alpine
    restart: always
    ports:
      - "80:80"
      - "443:443"
    volumes:
      - ./nginx.conf:/etc/nginx/nginx.conf:ro
      - ./ssl:/etc/nginx/ssl:ro
    depends_on:
      - frontend
      - api
      - paheko
    networks:
      - recyclique_network

volumes:
  postgres_data:
    driver: local
  redis_data:
    driver: local
  paheko_data:
    driver: local

networks:
  recyclique_network:
    driver: bridge
```

### Nginx Configuration

**Fichier** : `nginx.conf`

```nginx
upstream frontend {
    server frontend:3000;
}

upstream api {
    server api:8000;
}

upstream paheko {
    server paheko:80;
}

server {
    listen 80;
    server_name _;
    return 301 https://$host$request_uri;
}

server {
    listen 443 ssl http2;
    server_name recyclique.example.com;
    
    ssl_certificate /etc/nginx/ssl/cert.pem;
    ssl_certificate_key /etc/nginx/ssl/key.pem;
    ssl_protocols TLSv1.2 TLSv1.3;
    ssl_ciphers HIGH:!aNULL:!MD5;
    
    client_max_body_size 100M;
    
    # Frontend
    location / {
        proxy_pass http://frontend;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
    }
    
    # API RecyClique
    location /api/ {
        proxy_pass http://api/;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
        
        # Rate limiting
        limit_req zone=api burst=20 nodelay;
        limit_req_status 429;
    }
    
    # Paheko Admin
    location /admin/ {
        proxy_pass http://paheko/;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        auth_basic "Admin Paheko";
        auth_basic_user_file /etc/nginx/.htpasswd;
    }
}

# Rate limiting zones
limit_req_zone $binary_remote_addr zone=api:10m rate=10r/s;
```

### Monitoring

**Fichier** : `docker-compose.monitoring.yml`

```yaml
version: '3.8'

services:
  prometheus:
    image: prom/prometheus:latest
    restart: always
    volumes:
      - ./prometheus.yml:/etc/prometheus/prometheus.yml
      - prometheus_data:/prometheus
    command:
      - '--config.file=/etc/prometheus/prometheus.yml'
    ports:
      - "9090:9090"
    networks:
      - recyclique_network

  grafana:
    image: grafana/grafana:latest
    restart: always
    environment:
      GF_SECURITY_ADMIN_PASSWORD: ${GRAFANA_PASSWORD}
    volumes:
      - grafana_data:/var/lib/grafana
    ports:
      - "3001:3000"
    depends_on:
      - prometheus
    networks:
      - recyclique_network

volumes:
  prometheus_data:
  grafana_data:

networks:
  recyclique_network:
    external: true
```

---

## ğŸ”„ MAINTENANCE ET MISES Ã€ JOUR

### Mise Ã  Jour Paheko

```bash
# 1. Sauvegarder avant mise Ã  jour
./scripts/backup.sh

# 2. VÃ©rifier version actuelle
docker exec recyclique_paheko cat /var/www/paheko/VERSION

# 3. ArrÃªter le service
docker compose down paheko

# 4. Mettre Ã  jour l'image
docker pull paheko/paheko:latest

# 5. Relancer
docker compose up -d paheko

# 6. VÃ©rifier la santÃ©
docker compose logs -f paheko
```

### Mise Ã  Jour Extensions

```bash
# Via interface Paheko
Configuration > Extensions > VÃ©rifier mises Ã  jour

# Ou automatisÃ©e
docker exec recyclique_paheko \
  php /usr/local/bin/update-extensions.php
```

### Restauration depuis Sauvegarde

```bash
# Lister les sauvegardes disponibles
ls -lh backups/

# Restaurer PostgreSQL
gunzip -c backups/paheko_db_TIMESTAMP.sql.gz | \
  psql -h localhost -U paheko paheko_db

# Restaurer fichiers
tar -xzf backups/paheko_data_TIMESTAMP.tar.gz -C data/

# RedÃ©marrer les services
docker compose restart
```

### Nettoyage Docker

```bash
# Nettoyer images/conteneurs non utilisÃ©s
docker system prune -a --volumes

# VÃ©rifier l'espace disque
docker system df

# Voir les logs
docker compose logs paheko -f --tail=100

# Inspecter un service
docker compose exec paheko ps aux
```

---

## ğŸ› TROUBLESHOOTING

### PostgreSQL refuse de dÃ©marrer

```
SymptÃ´me: docker-compose logs postgres â†’ "FATAL: could not create..."

Solution:
1. VÃ©rifier permissions: chmod 755 data/postgres_data
2. Supprimer fichier cassÃ©: rm -f data/postgres_data/postmaster.pid
3. Rebuild: docker compose down && docker compose up -d postgres
```

### API FastAPI ne rÃ©pond pas

```
SymptÃ´me: curl http://localhost:4433 â†’ Connection refused

Solution:
1. VÃ©rifier le service: docker ps | grep api
2. Logs: docker compose logs api -f
3. Tester Paheko: curl http://localhost:8080/api/health
4. RedÃ©marrer: docker compose restart api
```

### Paheko ne se connecte pas Ã  PostgreSQL

```
SymptÃ´me: "SQLSTATE[HY000]: General error..."

Solution:
1. VÃ©rifier .env: grep POSTGRES_ .env
2. Tester connexion: psql -h localhost -U paheko -d paheko_db
3. VÃ©rifier DockerNetwork: docker network inspect recyclique_network
4. Restart services: docker compose down && docker compose up -d
```

### Caisse : pas de synchronisation comptable

```
SymptÃ´me: Ventes en caisse mais pas d'Ã©critures comptables

Solution:
1. VÃ©rifier extension caisse active
2. Configuration > Caisse > Comptes comptables
3. Re-exporter les ventes: Caisse > Sessions > Re-synchroniser
4. Logs Paheko: docker compose logs paheko
```

### Trop d'espace disque utilisÃ©

```
SymptÃ´me: data/paheko_data/ > 5 GB

Solution:
1. Nettoyer les documents: 
   Configuration > Gestion documents > Archive anciens
2. Archiver comptabilitÃ© ancienne
3. Exporter backup et supprimer donnÃ©es test
4. docker system prune -a
```

---

## ğŸ“š RESSOURCES

### Documentation Officielle

- **Paheko** : https://paheko.cloud/aide (500+ pages)
- **API REST** : https://paheko.cloud/api
- **Code Source** : https://github.com/paheko/paheko
- **Forum** : https://fossil.kd2.org/paheko/

### HÃ©bergement & DÃ©ploiement

- **YunoHost Paheko** : https://github.com/YunoHost-Apps/paheko_ynh
- **Docker Hub** : docker pull paheko/paheko:latest
- **Guides Tiers** : wiki.infini.fr, la-contrevoie.fr

### Formation & Support

- **Webinaires** : Les Ruchettes Associatives (franÃ§ais)
- **CommunautÃ©** : Slack, Forum officiel
- **Experts Paheko** : Contact sur site officiel

### Outils ComplÃ©mentaires

- **BÃ©nÃ©valibre** : Saisie temps bÃ©nÃ©vole (import Paheko)
- **NextCloud** : IntÃ©gration (https://github.com/kd2org/paheko-nextcloud)
- **YunoHost** : Plateforme hÃ©bergement auto-hÃ©bergÃ©e

---

## ğŸ“‹ ANNEXES

### A. Variables d'environnement complÃ¨tes

```bash
# .env template complet

# ===== DATABASE =====
POSTGRES_USER=paheko
POSTGRES_PASSWORD=SecurePassword123!
POSTGRES_DB=paheko_db
DB_HOST=postgres
DB_PORT=5432

# ===== REDIS =====
REDIS_PASSWORD=RedisSecure456!
REDIS_HOST=redis
REDIS_PORT=6379

# ===== PAHEKO =====
PAHEKO_API_USER=api_recyclique
PAHEKO_API_PASSWORD=APISecure789!
PAHEKO_WWW_URI=/
PAHEKO_FILE_STORAGE_QUOTA=5000000

# ===== NETWORK =====
DOMAIN=localhost
FRONTEND_PORT=4444
API_PORT=4433
PAHEKO_PORT=8080

# ===== SECURITY =====
GRAFANA_PASSWORD=GrafanaAdmin123!
```

### B. Commandes Docker Courantes

```bash
# DÃ©marrer services
docker compose up -d

# Voir les logs
docker compose logs -f [service]

# AccÃ©der au shell d'un service
docker compose exec [service] bash

# ArrÃªter tout
docker compose down

# Nettoyer (âš ï¸  supprime donnÃ©es)
docker compose down -v

# RedÃ©marrer service unique
docker compose restart [service]

# VÃ©rifier santÃ©
docker compose ps
docker compose stats

# ExÃ©cuter commande ponctuellement
docker compose exec paheko php -v

# Copier fichier de container
docker cp recyclique_paheko:/var/www/paheko/VERSION ./

# Voir configuration container
docker inspect recyclique_paheko
```

### C. SQL Utile Paheko

```sql
-- Voir les ventes du jour
SELECT * FROM compta_ventes 
WHERE date = CURRENT_DATE
ORDER BY date DESC;

-- Statistiques caisse par catÃ©gorie
SELECT 
    c.libelle as categorie,
    SUM(cv.montant) as total,
    COUNT(*) as nb_ventes
FROM compta_ventes cv
JOIN compta_comptes c ON cv.compte = c.numero
WHERE cv.date >= CURRENT_DATE - 7
GROUP BY c.libelle
ORDER BY total DESC;

-- Heures bÃ©nÃ©vole par personne (derniÃ¨re semaine)
SELECT 
    m.nom,
    SUM(tb.duree) as heures,
    SUM(tb.duree * tb.taux_horaire) as valorise
FROM temps_benevolat tb
JOIN membres m ON tb.membre_id = m.id
WHERE tb.date >= CURRENT_DATE - 7
GROUP BY m.id, m.nom
ORDER BY heures DESC;

-- Objets en stock par catÃ©gorie
SELECT 
    categorie,
    COUNT(*) as nb,
    AVG(CAST(prix AS NUMERIC)) as prix_moyen,
    MAX(date_entree) as entree_recente
FROM gestion_materiel
WHERE statut = 'stock'
GROUP BY categorie
ORDER BY nb DESC;
```

### D. Checklist Go-Live

- [ ] Instance Production dÃ©ployÃ©e & testÃ©e
- [ ] Sauvegardes automatiques en place
- [ ] Monitoring actif (Prometheus + Grafana)
- [ ] Alertes configurÃ©es (email/Slack)
- [ ] Documentation utilisateur distribuÃ©e
- [ ] Formation bÃ©nÃ©voles/staff complÃ©tÃ©e
- [ ] Hotline support dÃ©finie
- [ ] DonnÃ©es initiales importÃ©es
- [ ] DerniÃ¨re sauvegarde de sÃ©curitÃ© effectuÃ©e
- [ ] Go/No-go dÃ©cision management
- [ ] Rollback procedure testÃ©e

---

**FIN DU GUIDE**

Document gÃ©nÃ©rÃ© le: 2025-11-21  
Version: 1.0  
Distribution: RecyClique v1.3.17 + Paheko 1.3.17

Pour toute question, contactez: support@recyclique.example.com